version: "3.8"

services:
  frontend:
    build: ../frontend
    networks: 
      - traefik-net
    expose:
      - 80
    labels:
    - "traefik.enable=true"
    - "traefik.http.routers.demo.rule=Host(`demo.localhost`)"
    - "traefik.http.middlewares.image_optimizer.plugin.dev.foo=bar"
    - "traefik.http.middlewares.image_optimizer.plugin.dev.config.processor=imaginary"
    - "traefik.http.middlewares.image_optimizer.plugin.dev.config.imaginary.url=http://imaginary:9000"
    - "traefik.http.routers.demo.middlewares=image_optimizer"

networks:
  traefik-net:
    external:
      name: traefik-net
